root@SRV-NBM-CLOUD-01[~]# # Verificar se o código app.get('/') está no build
grep -o "app\.get.*\/" /opt/nbm-cloud/dist/index.cjs | head -5

# Verificar se o build tem a string "no-store"
grep -c "no-store" /opt/nbm-cloud/dist/index.cjs

# Ver os logs do PM2 para erros
pm2 logs nbm-cloud --lines 5 --err
app.get("trust proxy fn");if(!r(this.connection.remoteAddress,0))return e;var n=this.get("X-Forwarded-Proto")||e,i=n.indexOf(",");return i!==-1?n.substring(0,i).trim():n.trim()});Mr(Me,"secure",function(){return this.protocol==="https"});Mr(Me,"ip",function(){var e=this.app.get("trust proxy fn");return pT(this,e)});Mr(Me,"ips",function(){var e=this.app.get("trust proxy fn"),r=pT.all(this,e);return r.reverse().pop(),r});Mr(Me,"subdomains",function(){var e=this.hostname;if(!e)return[];var r=this.app.get("subdomain offset"),n=mU(e)?[e]:e.split(".").reverse();return n.slice(r)});Mr(Me,"path",function(){return bU(this).pathname});Mr(Me,"hostname",function(){var e=this.app.get("trust proxy fn"),r=this.get("X-Forwarded-Host");if(!r||!e(this.connection.remoteAddress,0)?r=this.get("Host"):r.indexOf(",")!==-1&&(r=r.substring(0,r.indexOf(",")).trimRight()),!!r){var n=r[0]==="["?r.indexOf("]")+1:0,i=r.indexOf(":",n);return i!==-1?r.substring(0,i):r}});Mr(Me,"host",Wo.function(function(){return this.hostname},"req.host: Use req.hostname instead"));Mr(Me,"fresh",function(){var t=this.method,e=this.res,r=e.statusCode;return t!=="GET"&&t!=="HEAD"?!1:r>=200&&r<300||r===304?yU(this.headers,{etag:e.get("ETag"),"last-modified":e.get("Last-Modified")}):!1});Mr(Me,"stale",function(){return!this.fresh});Mr(Me,"xhr",function(){var e=this.get("X-Requested-With")||"";return e.toLowerCase()==="xmlhttprequest"});function Mr(t,e,r){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:r})}});var gT=v(kl=>{var hT=require("crypto");kl.sign=function(t,e){if(typeof t!="string")throw new TypeError("Cookie value must be provided as a string.");if(typeof e!="string")throw new TypeError("Secret string must be provided.");return t+"."+hT.createHmac("sha256",e).update(t).digest("base64").replace(/\=+$/,"")};kl.unsign=function(t,e){if(typeof t!="string")throw new TypeError("Signed cookie string must be provided.");if(typeof e!="string")throw new TypeError("Secret string must be provided.");var r=t.slice(0,t.lastIndexOf(".")),n=kl.sign(r,e);return mT(n)==mT(t)?r:!1};function mT(t){return hT.createHash("sha1").update(t).digest("hex")}});var bT=v(Vm=>{"use strict";Vm.parse=kU;Vm.serialize=AU;var xU=Object.prototype.toString,wU=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/,_U=/^("?)[\u0021\u0023-\u002B\u002D-\u003A\u003C-\u005B\u005D-\u007E]*\1$/,SU=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,EU=/^[\u0020-\u003A\u003D-\u007E]*$/;function kU(t,e){if(typeof t!="string")throw new TypeError("argument str must be a string");var r={},n=t.length;if(n<2)return r;var i=e&&e.decode||TU,s=0,a=0,o=0;do{if(a=t.indexOf("=",s),a===-1)break;if(o=t.indexOf(";",s),o===-1)o=n;else if(a>o){s=t.lastIndexOf(";",a-1)+1;continue}var u=yT(t,s,a),c=vT(t,a,u),l=t.slice(u,c);if(!r.hasOwnProperty(l)){var f=yT(t,a+1,o),h=vT(t,o,f);t.charCodeAt(f)===34&&t.charCodeAt(h-1)===34&&(f++,h--);var g=t.slice(f,h);r[l]=IU(g,i)}s=o+1}while(s<n);return r}function yT(t,e,r){do{var n=t.charCodeAt(e);if(n!==32&&n!==9)return e}while(++e<r);return r}function vT(t,e,r){for(;e>r;){var n=t.charCodeAt(--e);if(n!==32&&n!==9)return e+1}return r}function AU(t,e,r){var n=r&&r.encode||encodeURIComponent;if(typeof n!="function")throw new TypeError("option encode is invalid");if(!wU.test(t))throw new TypeError("argument name is invalid");var i=n(e);if(!_U.test(i))throw new TypeError("argument val is invalid");var s=t+"="+i;if(!r)return s;if(r.maxAge!=null){var a=Math.floor(r.maxAge);if(!isFinite(a))throw new TypeError("option maxAge is invalid");s+="; Max-Age="+a}if(r.domain){if(!SU.test(r.domain))throw new TypeError("option domain is invalid");s+="; Domain="+r.domain}if(r.path){if(!EU.test(r.path))throw new TypeError("option path is invalid");s+="; Path="+r.path}if(r.expires){var o=r.expires;if(!CU(o)||isNaN(o.valueOf()))throw new TypeError("option expires is invalid");s+="; Expires="+o.toUTCString()}if(r.httpOnly&&(s+="; HttpOnly"),r.secure&&(s+="; Secure"),r.partitioned&&(s+="; Partitioned"),r.priority){var u=typeof r.priority=="string"?r.priority.toLowerCase():r.priority;switch(u){case"low":s+="; Priority=Low";break;case"medium":s+="; Priority=Medium";break;case"high":s+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}}if(r.sameSite){var c=typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite;switch(c){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;case"none":s+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return s}function TU(t){return t.indexOf("%")!==-1?decodeURIComponent(t):t}function CU(t){return xU.call(t)==="[object Date]"}function IU(t,e){try{return e(t)}catch{return t}}});var _T=v((qte,Wm)=>{"use strict";Wm.exports=OU;Wm.exports.append=wT;var PU=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/;function wT(t,e){if(typeof t!="string")throw new TypeError("header argument is required");if(!e)throw new TypeError("field argument is required");for(var r=Array.isArray(e)?e:xT(String(e)),n=0;n<r.length;n++)if(!PU.test(r[n]))throw new TypeError("field argument contains an invalid header name");if(t==="*")return t;var i=t,s=xT(t.toLowerCase());if(r.indexOf("*")!==-1||s.indexOf("*")!==-1)return"*";for(var a=0;a<r.length;a++){var o=r[a].toLowerCase();s.indexOf(o)===-1&&(s.push(o),i=i?i+", "+r[a]:r[a])}return i}function xT(t){for(var e=0,r=[],n=0,i=0,s=t.length;i<s;i++)switch(t.charCodeAt(i)){case 32:n===e&&(n=e=i+1);break;case 44:r.push(t.substring(n,e)),n=e=i+1;break;default:e=i+1;break}return r.push(t.substring(n,e)),r}function OU(t,e){if(!t||!t.getHeader||!t.setHeader)throw new TypeError("res argument is required");var r=t.getHeader("Vary")||"",n=Array.isArray(r)?r.join(", "):String(r);(r=wT(n,e))&&t.setHeader("Vary",r)}});var PT=v((Bte,IT)=>{"use strict";var Qo=zs().Buffer,ST=wm(),NU=vi(),er=wr()("express"),jU=al(),RU=Oo(),qU=require("http"),BU=Jn().isAbsolute,DU=po(),ET=require("path"),Al=to(),kT=$s(),MU=gT().sign,LU=Jn().normalizeType,UU=Jn().normalizeTypes,FU=Jn().setCharset,$U=bT(),Qm=bl(),zU=ET.extname,AT=Qm.mime,HU=ET.resolve,VU=_T(),$e=Object.create(qU.ServerResponse.prototype);IT.exports=$e;var WU=/;\s*charset\s*=/;$e.status=function(e){return(typeof e=="string"||Math.floor(e)!==e)&&e>99&&e<1e3&&er("res.status("+JSON.stringify(e)+"): use res.status("+Math.floor(e)+") instead"),this.statusCode=e,this};$e.links=function(t){var e=this.get("Link")||"";return e&&(e+=", "),this.set("Link",e+Object.keys(t).map(function(r){return"<"+t[r]+'>; rel="'+r+'"'}).join(", "))};$e.send=function(e){var r=e,n,i=this.req,s,a=this.app;switch(arguments.length===2&&(typeof arguments[0]!="number"&&typeof arguments[1]=="number"?(er("res.send(body, status): Use res.status(status).send(body) instead"),this.statusCode=arguments[1]):(er("res.send(status, body): Use res.status(status).send(body) instead"),this.statusCode=arguments[0],r=arguments[1])),typeof r=="number"&&arguments.length===1&&(this.get("Content-Type")||this.type("txt"),er("res.send(status): Use res.sendStatus(status) instead"),this.statusCode=r,r=Al.message[r]),typeof r){case"string":this.get("Content-Type")||this.type("html");break;case"boolean":case"number":case"object":if(r===null)r="";else if(Qo.isBuffer(r))this.get("Content-Type")||this.type("bin");else return this.json(r);break}typeof r=="string"&&(n="utf8",s=this.get("Content-Type"),typeof s=="string"&&this.set("Content-Type",FU(s,"utf-8")));var o=a.get("etag fn"),u=!this.get("ETag")&&typeof o=="function",c;r!==void 0&&(Qo.isBuffer(r)?c=r.length:!u&&r.length<1e3?c=Qo.byteLength(r,n):(r=Qo.from(r,n),n=void 0,c=r.length),this.set("Content-Length",c));var l;return u&&c!==void 0&&(l=o(r,n))&&this.set("ETag",l),i.fresh&&(this.statusCode=304),(this.statusCode===204||this.statusCode===304)&&(this.removeHeader("Content-Type"),this.removeHeader("Content-Length"),this.removeHeader("Transfer-Encoding"),r=""),this.statusCode===205&&(this.set("Content-Length","0"),this.removeHeader("Transfer-Encoding"),r=""),i.method==="HEAD"?this.end():this.end(r,n),this};$e.json=function(e){var r=e;arguments.length===2&&(typeof arguments[1]=="number"?(er("res.json(obj, status): Use res.status(status).json(obj) instead"),this.statusCode=arguments[1]):(er("res.json(status, obj): Use res.status(status).json(obj) instead"),this.statusCode=arguments[0],r=arguments[1]));var n=this.app,i=n.get("json escape"),s=n.get("json replacer"),a=n.get("json spaces"),o=CT(r,s,a,i);return this.get("Content-Type")||this.set("Content-Type","application/json"),this.send(o)};$e.jsonp=function(e){var r=e;arguments.length===2&&(typeof arguments[1]=="number"?(er("res.jsonp(obj, status): Use res.status(status).jsonp(obj) instead"),this.statusCode=arguments[1]):(er("res.jsonp(status, obj): Use res.status(status).jsonp(obj) instead"),this.statusCode=arguments[0],r=arguments[1]));var n=this.app,i=n.get("json escape"),s=n.get("json replacer"),a=n.get("json spaces"),o=CT(r,s,a,i),u=this.req.query[n.get("jsonp callback name")];return this.get("Content-Type")||(this.set("X-Content-Type-Options","nosniff"),this.set("Content-Type","application/json")),Array.isArray(u)&&(u=u[0]),typeof u=="string"&&u.length!==0&&(this.set("X-Content-Type-Options","nosniff"),this.set("Content-Type","text/javascript"),u=u.replace(/[^\[\]\w$.]/g,""),o===void 0?o="":typeof o=="string"&&(o=o.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")),o="/**/ typeof "+u+" === 'function' && "+u+"("+o+");"),this.send(o)};$e.sendStatus=function(e){var r=Al.message[e]||String(e);return this.statusCode=e,this.type("txt"),this.send(r)};$e.sendFile=function(e,r,n){var i=n,s=this.req,a=this,o=s.next,u=r||{};if(!e)throw new TypeError("path argument is required to res.sendFile");if(typeof e!="string")throw new TypeError("path must be a string to res.sendFile");if(typeof r=="function"&&(i=r,u={}),!u.root&&!BU(e))throw new TypeError("path must be absolute or specify root to res.sendFile");var c=encodeURI(e),l=Qm(s,c,u);TT(a,l,u,function(f){if(i)return i(f);if(f&&f.code==="EISDIR")return o();f&&f.code!=="ECONNABORTED"&&f.syscall!=="write"&&o(f)})};$e.sendfile=function(t,e,r){var n=r,i=this.req,s=this,a=i.next,o=e||{};typeof e=="function"&&(n=e,o={});var u=Qm(i,t,o);TT(s,u,o,function(c){if(n)return n(c);if(c&&c.code==="EISDIR")return a();c&&c.code!=="ECONNABORTED"&&c.syscall!=="write"&&a(c)})};$e.sendfile=er.function($e.sendfile,"res.sendfile: Use res.sendFile instead");$e.download=function(e,r,n,i){var s=i,a=r,o=n||null;typeof r=="function"?(s=r,a=null,o=null):typeof n=="function"&&(s=n,o=null),typeof r=="object"&&(typeof n=="function"||n===void 0)&&(a=null,o=r);var u={"Content-Disposition":ST(a||e)};if(o&&o.headers)for(var c=Object.keys(o.headers),l=0;l<c.length;l++){var f=c[l];f.toLowerCase()!=="content-disposition"&&(u[f]=o.headers[f])}o=Object.create(o),o.headers=u;var h=o.root?e:HU(e);return this.sendFile(h,o,s)};$e.contentType=$e.type=function(e){var r=e.indexOf("/")===-1?AT.lookup(e):e;return this.set("Content-Type",r)};$e.format=function(t){var e=this.req,r=e.next,n=Object.keys(t).filter(function(s){return s!=="default"}),i=n.length>0?e.accepts(n):!1;return this.vary("Accept"),i?(this.set("Content-Type",LU(i).value),t[i](e,this,r)):t.default?t.default(e,this,r):r(NU(406,{types:UU(n).map(function(s){return s.value})})),this};$e.attachment=function(e){return e&&this.type(zU(e)),this.set("Content-Disposition",ST(e)),this};$e.append=function(e,r){var n=this.get(e),i=r;return n&&(i=Array.isArray(n)?n.concat(r):Array.isArray(r)?[n].concat(r):[n,r]),this.set(e,i)};$e.set=$e.header=function(e,r){if(arguments.length===2){var n=Array.isArray(r)?r.map(String):String(r);if(e.toLowerCase()==="content-type"){if(Array.isArray(n))throw new TypeError("Content-Type cannot be set to an Array");if(!WU.test(n)){var i=AT.charsets.lookup(n.split(";")[0]);i&&(n+="; charset="+i.toLowerCase())}}this.setHeader(e,n)}else for(var s in e)this.set(s,e[s]);return this};$e.get=function(t){return this.getHeader(t)};$e.clearCookie=function(e,r){r&&(r.maxAge&&er('res.clearCookie: Passing "options.maxAge" is deprecated. In v5.0.0 of Express, this option will be ignored, as res.clearCookie will automatically set cookies to expire immediately. Please update your code to omit this option.'),r.expires&&er('res.clearCookie: Passing "options.expires" is deprecated. In v5.0.0 of Express, this option will be ignored, as res.clearCookie will automatically set cookies to expire immediately. Please update your code to omit this option.'));var n=kT({expires:new Date(1),path:"/"},r);return this.cookie(e,"",n)};$e.cookie=function(t,e,r){var n=kT({},r),i=this.req.secret,s=n.signed;if(s&&!i)throw new Error('cookieParser("secret") required for signed cookies');var a=typeof e=="object"?"j:"+JSON.stringify(e):String(e);if(s&&(a="s:"+MU(a,i)),n.maxAge!=null){var o=n.maxAge-0;isNaN(o)||(n.expires=new Date(Date.now()+o),n.maxAge=Math.floor(o/1e3))}return n.path==null&&(n.path="/"),this.append("Set-Cookie",$U.serialize(t,String(a),n)),this};$e.location=function(e){var r;return e==="back"?(er('res.location("back"): use res.location(req.get("Referrer") || "/") and refer to https://dub.sh/security-redirect for best practices'),r=this.req.get("Referrer")||"/"):r=String(e),this.set("Location",jU(r))};$e.redirect=function(e){var r=e,n,i=302;arguments.length===2&&(typeof arguments[0]=="number"?(i=arguments[0],r=arguments[1]):(er("res.redirect(url, status): Use res.redirect(status, url) instead"),i=arguments[1])),r=this.location(r).get("Location"),this.format({text:function(){n=Al.message[i]+". Redirecting to "+r},html:function(){var s=RU(r);n="<p>"+Al.message[i]+". Redirecting to "+s+"</p>"},default:function(){n=""}}),this.statusCode=i,this.set("Content-Length",Qo.byteLength(n)),this.req.method==="HEAD"?this.end():this.end(n)};$e.vary=function(t){return!t||Array.isArray(t)&&!t.length?(er("res.vary(): Provide a field name"),this):(VU(this,t),this)};$e.render=function(e,r,n){var i=this.req.app,s=n,a=r||{},o=this.req,u=this;typeof r=="function"&&(s=r,a={}),a._locals=u.locals,s=s||function(c,l){if(c)return o.next(c);u.send(l)},i.render(e,a,s)};function TT(t,e,r,n){var i=!1,s;function a(){if(!i){i=!0;var g=new Error("Request aborted");g.code="ECONNABORTED",n(g)}}function o(){if(!i){i=!0;var g=new Error("EISDIR, read");g.code="EISDIR",n(g)}}function u(g){i||(i=!0,n(g))}function c(){i||(i=!0,n())}function l(){s=!1}function f(g){if(g&&g.code==="ECONNRESET")return a();if(g)return u(g);i||setImmediate(function(){if(s!==!1&&!i){a();return}i||(i=!0,n())})}function h(){s=!0}e.on("directory",o),e.on("end",c),e.on("error",u),e.on("file",l),e.on("stream",h),DU(t,f),r.headers&&e.on("headers",function(b){for(var y=r.headers,k=Object.keys(y),I=0;I<k.length;I++){var D=k[I];b.setHeader(D,y[D])}}),e.pipe(t)}function CT(t,e,r,n){var i=e||r?JSON.stringify(t,e,r):JSON.stringify(t);return n&&typeof i=="string"&&(i=i.replace(/[<>&]/g,function(s){switch(s.charCodeAt(0)){case 60:return"\\u003c";case 62:return"\\u003e";case 38:return"\\u0026";default:return s}})),i}});var NT=v((Dte,Jm)=>{"use strict";var QU=al(),GU=Oo(),Gm=Ci(),JU=require("path").resolve,OT=bl(),KU=require("url");Jm.exports=ZU;Jm.exports.mime=OT.mime;function ZU(t,e){if(!t)throw new TypeError("root path required");if(typeof t!="string")throw new TypeError("root path must be a string");var r=Object.create(e||null),n=r.fallthrough!==!1,i=r.redirect!==!1,s=r.setHeaders;if(s&&typeof s!="function")throw new TypeError("option setHeaders must be function");r.maxage=r.maxage||r.maxAge||0,r.root=JU(t);var a=i?tF():eF();return function(u,c,l){if(u.method!=="GET"&&u.method!=="HEAD"){if(n)return l();c.statusCode=405,c.setHeader("Allow","GET, HEAD"),c.setHeader("Content-Length","0"),c.end();return}var f=!n,h=Gm.original(u),g=Gm(u).pathname;g==="/"&&h.pathname.substr(-1)!=="/"&&(g="");var b=OT(u,g,r);b.on("directory",a),s&&b.on("headers",s),n&&b.on("file",function(){f=!0}),b.on("error",function(k){if(f||!(k.statusCode<500)){l(k);return}l()}),b.pipe(c)}}function YU(t){for(var e=0;e<t.length&&t.charCodeAt(e)===47;e++);return e>1?"/
1
[TAILING] Tailing last 5 lines for [nbm-cloud] process (change the value with --lines option)
/var/log/nbm-cloud/error-0.log last 5 lines:
0|nbm-clou |     at Module._compile (node:internal/modules/cjs/loader:1521:14)
0|nbm-clou |     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
0|nbm-clou |     at Module.load (node:internal/modules/cjs/loader:1266:32)
0|nbm-clou |     at Module._load (node:internal/modules/cjs/loader:1091:12)
0|nbm-clou |     at cjsLoader (node:internal/modules/esm/translators:298:15)


