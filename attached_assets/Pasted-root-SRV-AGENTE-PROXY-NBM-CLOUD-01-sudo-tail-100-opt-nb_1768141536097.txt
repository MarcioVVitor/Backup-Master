root@SRV-AGENTE-PROXY-NBM-CLOUD-01[~]# sudo tail -100 /opt/nbm-agent/logs/agent.log
[2026-01-11 11:18:22] [DEBUG] Sent heartbeat
[2026-01-11 11:18:22] [DEBUG] Received: {"type":"heartbeat_ack","timestamp":"2026-01-11T14:18:22.785Z"}
[2026-01-11 11:18:22] [DEBUG] Heartbeat acknowledged
[2026-01-11 11:18:37] [DEBUG] Sent heartbeat
[2026-01-11 11:18:37] [DEBUG] Received: {"type":"heartbeat_ack","timestamp":"2026-01-11T14:18:37.792Z"}
[2026-01-11 11:18:37] [DEBUG] Heartbeat acknowledged
[2026-01-11 11:18:46] [INFO] Stopping agent (PID: 53633)...
[2026-01-11 11:18:46] [INFO] Agent stopped
[2026-01-11 11:18:46] [INFO] Configuration loaded: Agent=proxy-grupojet-01, Server=http://143.255.197.25:5000
[2026-01-11 11:18:46] [INFO] Starting NBM CLOUD Agent v1.0.24
[2026-01-11 11:18:46] [INFO] Agent started with PID: 53934
[2026-01-11 11:18:46] [INFO] Connecting to WebSocket: ws://143.255.197.25:5000/ws/agents
[2026-01-11 11:18:46] [INFO] Establishing WebSocket connection...
[2026-01-11 11:18:46] [DEBUG] WebSocket process started with PID: 53946
[2026-01-11 11:18:46] [DEBUG] Sent auth message
[2026-01-11 11:18:46] [DEBUG] Received: {"type":"auth_success","agentId":1,"config":null}
[2026-01-11 11:18:46] [INFO] Authentication successful
[2026-01-11 11:19:01] [DEBUG] Sent heartbeat
[2026-01-11 11:19:01] [DEBUG] Received: {"type":"heartbeat_ack","timestamp":"2026-01-11T14:19:01.154Z"}
[2026-01-11 11:19:01] [DEBUG] Heartbeat acknowledged
[2026-01-11 11:19:07] [DEBUG] Received: {"type":"backup_job","jobId":"backup-15-1768141147324","equipment":{"id":15,"name":"OLT-ACE-GNA-NOKIA-ANDRADE-01","ip":"172.16.31.18","port":22,"protocol":"ssh","username":"isadmin","password":"@2Dc9d967","enablePassword":"","manufacturer":"nokia"},"config":{"command":"admin display-config","useShell":true,"timeout":60000}}
[2026-01-11 11:19:07] [DEBUG] Received message type: backup_job
[2026-01-11 11:19:07] [INFO] Executing backup job backup-15-1768141147324 for 172.16.31.18:22 with command: admin display-config
[2026-01-11 11:19:07] [DEBUG] Nokia device - using expect session
[2026-01-11 11:19:07] [INFO] Executing Nokia backup with expect on 172.16.31.18:22
[2026-01-11 11:19:07] [ERROR] Nokia expect error: spawn ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o ConnectTimeout=30 -o ServerAliveInterval=5 -o ServerAliveCountMax=60 -o TCPKeepAlive=yes -p 22 isadmin@172.16.31.18
Unable to negotiate with 172.16.31.18 port 22: no matching host key type found. Their offer: ssh-rsa
EXPECT_ERROR: Connection closed
[2026-01-11 11:19:07] [ERROR] Backup failed for 172.16.31.18
[2026-01-11 11:19:07] [INFO] Sending response, length: 108 bytes
[2026-01-11 11:19:07] [INFO] Response sent successfully (108 bytes)
[2026-01-11 11:19:16] [DEBUG] Sent heartbeat
[2026-01-11 11:19:16] [DEBUG] Received: {"type":"heartbeat_ack","timestamp":"2026-01-11T14:19:16.145Z"}
[2026-01-11 11:19:16] [DEBUG] Heartbeat acknowledged
[2026-01-11 11:19:31] [DEBUG] Sent heartbeat
[2026-01-11 11:19:31] [DEBUG] Received: {"type":"heartbeat_ack","timestamp":"2026-01-11T14:19:31.151Z"}
[2026-01-11 11:19:31] [DEBUG] Heartbeat acknowledged
[2026-01-11 11:19:46] [DEBUG] Sent heartbeat
[2026-01-11 11:19:46] [DEBUG] Received: {"type":"heartbeat_ack","timestamp":"2026-01-11T14:19:46.170Z"}
[2026-01-11 11:19:46] [DEBUG] Heartbeat acknowledged
[2026-01-11 11:20:01] [DEBUG] Sent heartbeat
[2026-01-11 11:20:01] [DEBUG] Received: {"type":"heartbeat_ack","timestamp":"2026-01-11T14:20:01.181Z"}
[2026-01-11 11:20:01] [DEBUG] Heartbeat acknowledged
[2026-01-11 11:20:16] [DEBUG] Sent heartbeat
[2026-01-11 11:20:16] [DEBUG] Received: {"type":"heartbeat_ack","timestamp":"2026-01-11T14:20:16.182Z"}
[2026-01-11 11:20:16] [DEBUG] Heartbeat acknowledged
[2026-01-11 11:20:31] [DEBUG] Sent heartbeat
[2026-01-11 11:20:31] [DEBUG] Received: {"type":"heartbeat_ack","timestamp":"2026-01-11T14:20:31.194Z"}
[2026-01-11 11:20:31] [DEBUG] Heartbeat acknowledged
[2026-01-11 11:20:46] [DEBUG] Sent heartbeat
[2026-01-11 11:20:46] [DEBUG] Received: {"type":"heartbeat_ack","timestamp":"2026-01-11T14:20:46.192Z"}
[2026-01-11 11:20:46] [DEBUG] Heartbeat acknowledged
[2026-01-11 11:21:01] [DEBUG] Sent heartbeat
[2026-01-11 11:21:01] [DEBUG] Received: {"type":"heartbeat_ack","timestamp":"2026-01-11T14:21:01.208Z"}
[2026-01-11 11:21:01] [DEBUG] Heartbeat acknowledged
[2026-01-11 11:21:16] [DEBUG] Sent heartbeat
[2026-01-11 11:21:16] [DEBUG] Received: {"type":"heartbeat_ack","timestamp":"2026-01-11T14:21:16.208Z"}
[2026-01-11 11:21:16] [DEBUG] Heartbeat acknowledged
[2026-01-11 11:21:31] [DEBUG] Sent heartbeat
[2026-01-11 11:21:31] [DEBUG] Received: {"type":"heartbeat_ack","timestamp":"2026-01-11T14:21:31.221Z"}
[2026-01-11 11:21:31] [DEBUG] Heartbeat acknowledged
[2026-01-11 11:21:46] [DEBUG] Sent heartbeat
[2026-01-11 11:21:46] [DEBUG] Received: {"type":"heartbeat_ack","timestamp":"2026-01-11T14:21:46.223Z"}
[2026-01-11 11:21:46] [DEBUG] Heartbeat acknowledged
[2026-01-11 11:22:01] [DEBUG] Sent heartbeat
[2026-01-11 11:22:01] [DEBUG] Received: {"type":"heartbeat_ack","timestamp":"2026-01-11T14:22:01.235Z"}
[2026-01-11 11:22:01] [DEBUG] Heartbeat acknowledged
[2026-01-11 11:22:14] [INFO] Stopping agent (PID: 53934)...
[2026-01-11 11:22:14] [INFO] Agent stopped
[2026-01-11 11:22:15] [INFO] Configuration loaded: Agent=proxy-grupojet-01, Server=http://143.255.197.25:5000
[2026-01-11 11:22:15] [INFO] Starting NBM CLOUD Agent v1.0.25
[2026-01-11 11:22:15] [INFO] Agent started with PID: 54184
[2026-01-11 11:22:15] [INFO] Connecting to WebSocket: ws://143.255.197.25:5000/ws/agents
[2026-01-11 11:22:15] [INFO] Establishing WebSocket connection...
[2026-01-11 11:22:15] [DEBUG] WebSocket process started with PID: 54195
[2026-01-11 11:22:15] [DEBUG] Sent auth message
[2026-01-11 11:22:15] [DEBUG] Received: {"type":"auth_success","agentId":1,"config":null}
[2026-01-11 11:22:15] [INFO] Authentication successful
[2026-01-11 11:22:30] [DEBUG] Sent heartbeat
[2026-01-11 11:22:30] [DEBUG] Received: {"type":"heartbeat_ack","timestamp":"2026-01-11T14:22:30.051Z"}
[2026-01-11 11:22:30] [DEBUG] Heartbeat acknowledged
[2026-01-11 11:22:45] [DEBUG] Sent heartbeat
[2026-01-11 11:22:45] [DEBUG] Received: {"type":"heartbeat_ack","timestamp":"2026-01-11T14:22:45.056Z"}
[2026-01-11 11:22:45] [DEBUG] Heartbeat acknowledged
[2026-01-11 11:22:53] [DEBUG] Received: {"type":"backup_job","jobId":"backup-15-1768141373370","equipment":{"id":15,"name":"OLT-ACE-GNA-NOKIA-ANDRADE-01","ip":"172.16.31.18","port":22,"protocol":"ssh","username":"isadmin","password":"@2Dc9d967","enablePassword":"","manufacturer":"nokia"},"config":{"command":"admin display-config","useShell":true,"timeout":60000}}
[2026-01-11 11:22:53] [DEBUG] Received message type: backup_job
[2026-01-11 11:22:53] [INFO] Executing backup job backup-15-1768141373370 for 172.16.31.18:22 with command: admin display-config
[2026-01-11 11:22:53] [DEBUG] Nokia device - using expect session
[2026-01-11 11:22:53] [INFO] Executing Nokia backup with expect on 172.16.31.18:22
[2026-01-11 11:23:00] [DEBUG] Sent heartbeat
[2026-01-11 11:23:15] [DEBUG] Sent heartbeat
[2026-01-11 11:23:30] [DEBUG] Sent heartbeat
[2026-01-11 11:23:45] [DEBUG] Sent heartbeat
[2026-01-11 11:24:00] [DEBUG] Sent heartbeat
[2026-01-11 11:24:15] [DEBUG] Sent heartbeat
[2026-01-11 11:24:30] [DEBUG] Sent heartbeat
[2026-01-11 11:24:45] [DEBUG] Sent heartbeat
[2026-01-11 11:25:00] [DEBUG] Sent heartbeat
[2026-01-11 11:25:15] [DEBUG] Sent heartbeat
[2026-01-11 11:25:30] [DEBUG] Sent heartbeat
root@SRV-AGENTE-PROXY-NBM-CLOUD-01[~]# 
